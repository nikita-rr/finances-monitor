# Telegram Mini App - –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –ú–æ–Ω–∏—Ç–æ—Ä

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
npm install
```

## –ó–∞–ø—É—Å–∫ Mini App

### 1. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä –¥–ª—è Mini App:

```bash
npm run dev:miniapp
```

–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ `http://localhost:3000`

### 2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Mini App –≤ BotFather:

1. –û—Ç–∫—Ä–æ–π—Ç–µ [@BotFather](https://t.me/BotFather) –≤ Telegram
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/mybots`
3. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
4. –ù–∞–∂–º–∏—Ç–µ **Bot Settings** ‚Üí **Menu Button**
5. –ù–∞–∂–º–∏—Ç–µ **Configure menu button**
6. –í–≤–µ–¥–∏—Ç–µ URL –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
   - –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ ngrok: `https://your-ngrok-url.ngrok.io`
   - –î–ª—è production: `https://yourdomain.com`
7. –í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä: "üí∞ –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ"

### 3. –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ ngrok:

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ ngrok (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
# https://ngrok.com/download

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ ngrok –¥–ª—è –ø–æ—Ä—Ç–∞ 3000
ngrok http 3000
```

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ HTTPS URL –∏–∑ ngrok (–Ω–∞–ø—Ä–∏–º–µ—Ä, `https://abc123.ngrok.io`) –∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–≥–æ –≤ BotFather.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
tg-finance-monitor/
‚îú‚îÄ‚îÄ public/                  # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã Mini App
‚îÇ   ‚îú‚îÄ‚îÄ index.html          # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îÇ   ‚îú‚îÄ‚îÄ css/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ style.css       # –°—Ç–∏–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ js/
‚îÇ       ‚îî‚îÄ‚îÄ app.js          # –õ–æ–≥–∏–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ server.ts           # Express —Å–µ—Ä–≤–µ—Ä –¥–ª—è Mini App
‚îÇ   ‚îú‚îÄ‚îÄ index.ts            # Telegram –±–æ—Ç (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
‚îÇ   ‚îú‚îÄ‚îÄ storage.ts          # –†–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ types.ts            # TypeScript —Ç–∏–ø—ã
‚îÇ   ‚îî‚îÄ‚îÄ utils.ts            # –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞—Å—á–µ—Ç–æ–≤
‚îî‚îÄ‚îÄ package.json
```

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ Mini App

- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±—é–¥–∂–µ—Ç–∞ –Ω–∞ –ø–µ—Ä–∏–æ–¥
- üí∏ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–æ–≤
- üíµ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Ö–æ–¥–æ–≤
- üìä –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- üìÖ –†–∞—Å—á–µ—Ç –¥–Ω–µ–≤–Ω–æ–≥–æ –ª–∏–º–∏—Ç–∞
- üéØ –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —ç–∫–æ–Ω–æ–º–∏–∏/–ø–µ—Ä–µ—Ä–∞—Å—Ö–æ–¥–∞
- üìà –ü—Ä–æ–≥–Ω–æ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–Ω–µ–≤–Ω–æ–≥–æ –ª–∏–º–∏—Ç–∞
- üé® –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω –ø–æ–¥ Telegram —Ç–µ–º—É

## API Endpoints

- `GET /api/budget/:userId` - –ü–æ–ª—É—á–∏—Ç—å –±—é–¥–∂–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `POST /api/budget/:userId` - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±—é–¥–∂–µ—Ç
- `POST /api/transaction/:userId` - –î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
- `POST /api/budget/:userId/reset` - –°–±—Ä–æ—Å–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

## Production Deploy

### –í–∞—Ä–∏–∞–Ω—Ç 1: Vercel

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Vercel CLI: `npm i -g vercel`
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ: `vercel`
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π URL –≤ BotFather

### –í–∞—Ä–∏–∞–Ω—Ç 2: Heroku

1. –°–æ–∑–¥–∞–π—Ç–µ `Procfile`:
```
web: npm run start
```
2. –î–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ Heroku CLI –∏–ª–∏ GitHub integration

### –í–∞—Ä–∏–∞–Ω—Ç 3: VPS (nginx + pm2)

```bash
# Build –ø—Ä–æ–µ–∫—Ç–∞
npm run build

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ pm2
npm install -g pm2

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä
pm2 start dist/server.js --name "finance-miniapp"

# –ù–∞—Å—Ç—Ä–æ–π—Ç–µ nginx –∫–∞–∫ reverse proxy
```

## Environment Variables

–î–ª—è production –¥–æ–±–∞–≤—å—Ç–µ –≤ `.env`:

```
PORT=3000
NODE_ENV=production
```

## Troubleshooting

### Mini App –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤ Telegram

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ URL –∏—Å–ø–æ–ª—å–∑—É–µ—Ç HTTPS (–¥–ª—è production)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑–≤–Ω–µ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Menu Button –≤ BotFather

### –î–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª `data.json` –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –∑–∞–ø–∏—Å–∏
2. –î–ª—è production –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö (MongoDB, PostgreSQL)

### –û—à–∏–±–∫–∞ CORS

–°–µ—Ä–≤–µ—Ä —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å `cors`, –Ω–æ –µ—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–∞—é—Ç –ø—Ä–æ–±–ª–µ–º—ã:
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∑–∞–ø—Ä–æ—Å—ã –∏–¥—É—Ç –Ω–∞ —Ç–æ—Ç –∂–µ –¥–æ–º–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ CORS –≤ `server.ts`
