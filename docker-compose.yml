version: '3.9'
services:
  web:
    build: .
    container_name: tg-finance-miniapp
    restart: unless-stopped
    environment:
      - NODE_ENV=production
      - PORT=3000
    ports:
      - "80:3000"
    volumes:
      - ./data.json:/app/data.json
    command: ["node", "dist/server.js"]

  bot:
    build: .
    container_name: tg-finance-bot
    restart: unless-stopped
    environment:
      - NODE_ENV=production
      - BOT_TOKEN=${BOT_TOKEN}
    # Mount data.json to share state with web (optional, same file)
    volumes:
      - ./data.json:/app/data.json
    # No ports needed for bot
    command: ["node", "dist/index.js"]
